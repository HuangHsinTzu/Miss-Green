<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Miss Green</title>
    <link
      rel="icon"
      type="logoicon"
      href="static/resources/Miss Green Logo.ico"
    />
    <link rel="stylesheet" href="static/MissGreen.css" />
    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Sacramento&display=swap"
      rel="stylesheet"
    />
    <style>
      .navbar-brand {
        color: #727d6b;
        font-weight: 1000;
        font-size: xx-large;
        font-family: "Sacramento", cursive;
      }
      .navbar-brand:hover {
        color: #727d6b;
        font-weight: 1000;
        font-size: xx-large;
        font-family: "Sacramento", cursive;
      }
      .navbar-brand:visited {
        color: #727d6b;
        font-weight: 1000;
        font-size: xx-large;
        font-family: "Sacramento", cursive;
      }
      .quantity-container {
        display: flex; /* 使用flex布局 */
        align-items: center; /* 垂直居中对齐 */
      }

      .quantity-label {
        margin-right: 10px; /* 在标签和输入框之间添加一些间距 */
      }
      .add-to-cart {
        color: white;
        background-color: #727d6b;
        cursor: pointer;
        padding: 15px;
        border-radius: 10px;
        text-align: center;
        float: left;
        width: 48%;
      }
      .buy-now {
        color: white;
        background-color: #727d6b;
        cursor: pointer;
        padding: 15px;
        border-radius: 10px;
        text-align: center;
        float: right;
        width: 48%;
      }
      /* 父容器使用flex布局 */
      .buttons-container {
        display: flex;
        justify-content: space-between; /* 两个按钮分别位于父容器的两端 */
        margin: 10px; /* 给父容器添加一些间距 */
      }
      .productInfoDiv {
        margin: 20px;
        font-size: medium;
      }
      .scroll-body {
        overflow: auto; /* 设置为 auto 或 scroll 以便在内容溢出时显示滚动条 */
      }
      .inCart_buyNow {
        color: white;
        background-color: #727d6b;
        cursor: pointer;
        border-radius: 10px;
        text-align: center;
        float: right;
        width: 200px;
      }
    </style>
  </head>
  <body>
    <nav
      class="navbar navbar-expand-lg bg-body-tertiary sticky-top green-border-top"
    >
      <div class="container-fluid">
        <a class="navbar-brand" href="/">Miss Green</a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNavDropdown"
          aria-controls="navbarNavDropdown"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNavDropdown">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" href="/Items">商品總覽 | ALL ITEMS</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/ActivitiesRegistration"
                >農場活動 | Activities</a
              >
            </li>
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                聯絡我們｜CONTACT US
              </a>
              <ul class="dropdown-menu">
                <li>
                  <a class="dropdown-item" href="#"
                    ><svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="16"
                      height="16"
                      fill="currentColor"
                      class="bi bi-instagram custom-icon-color"
                      viewBox="0 0 16 16"
                    >
                      <path
                        d="M8 0C5.829 0 5.556.01 4.703.048 3.85.088 3.269.222 2.76.42a3.9 3.9 0 0 0-1.417.923A3.9 3.9 0 0 0 .42 2.76C.222 3.268.087 3.85.048 4.7.01 5.555 0 5.827 0 8.001c0 2.172.01 2.444.048 3.297.04.852.174 1.433.372 1.942.205.526.478.972.923 1.417.444.445.89.719 1.416.923.51.198 1.09.333 1.942.372C5.555 15.99 5.827 16 8 16s2.444-.01 3.298-.048c.851-.04 1.434-.174 1.943-.372a3.9 3.9 0 0 0 1.416-.923c.445-.445.718-.891.923-1.417.197-.509.332-1.09.372-1.942C15.99 10.445 16 10.173 16 8s-.01-2.445-.048-3.299c-.04-.851-.175-1.433-.372-1.941a3.9 3.9 0 0 0-.923-1.417A3.9 3.9 0 0 0 13.24.42c-.51-.198-1.092-.333-1.943-.372C10.443.01 10.172 0 7.998 0zm-.717 1.442h.718c2.136 0 2.389.007 3.232.046.78.035 1.204.166 1.486.275.373.145.64.319.92.599s.453.546.598.92c.11.281.24.705.275 1.485.039.843.047 1.096.047 3.231s-.008 2.389-.047 3.232c-.035.78-.166 1.203-.275 1.485a2.5 2.5 0 0 1-.599.919c-.28.28-.546.453-.92.598-.28.11-.704.24-1.485.276-.843.038-1.096.047-3.232.047s-2.39-.009-3.233-.047c-.78-.036-1.203-.166-1.485-.276a2.5 2.5 0 0 1-.92-.598 2.5 2.5 0 0 1-.6-.92c-.109-.281-.24-.705-.275-1.485-.038-.843-.046-1.096-.046-3.233s.008-2.388.046-3.231c.036-.78.166-1.204.276-1.486.145-.373.319-.64.599-.92s.546-.453.92-.598c.282-.11.705-.24 1.485-.276.738-.034 1.024-.044 2.515-.045zm4.988 1.328a.96.96 0 1 0 0 1.92.96.96 0 0 0 0-1.92m-4.27 1.122a4.109 4.109 0 1 0 0 8.217 4.109 4.109 0 0 0 0-8.217m0 1.441a2.667 2.667 0 1 1 0 5.334 2.667 2.667 0 0 1 0-5.334"
                      />
                    </svg>
                    Instagram</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" href="#"
                    ><svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="16"
                      height="16"
                      fill="currentColor"
                      class="bi bi-facebook custom-icon-color"
                      viewBox="0 0 16 16"
                    >
                      <path
                        d="M16 8.049c0-4.446-3.582-8.05-8-8.05C3.58 0-.002 3.603-.002 8.05c0 4.017 2.926 7.347 6.75 7.951v-5.625h-2.03V8.05H6.75V6.275c0-2.017 1.195-3.131 3.022-3.131.876 0 1.791.157 1.791.157v1.98h-1.009c-.993 0-1.303.621-1.303 1.258v1.51h2.218l-.354 2.326H9.25V16c3.824-.604 6.75-3.934 6.75-7.951"
                      />
                    </svg>
                    Facebook</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" href="#"
                    ><svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="16"
                      height="16"
                      fill="currentColor"
                      class="bi bi-line custom-icon-color"
                      viewBox="0 0 16 16"
                    >
                      <path
                        d="M8 0c4.411 0 8 2.912 8 6.492 0 1.433-.555 2.723-1.715 3.994-1.678 1.932-5.431 4.285-6.285 4.645-.83.35-.734-.197-.696-.413l.003-.018.114-.685c.027-.204.055-.521-.026-.723-.09-.223-.444-.339-.704-.395C2.846 12.39 0 9.701 0 6.492 0 2.912 3.59 0 8 0M5.022 7.686H3.497V4.918a.156.156 0 0 0-.155-.156H2.78a.156.156 0 0 0-.156.156v3.486c0 .041.017.08.044.107v.001l.002.002.002.002a.15.15 0 0 0 .108.043h2.242c.086 0 .155-.07.155-.156v-.56a.156.156 0 0 0-.155-.157m.791-2.924a.156.156 0 0 0-.156.156v3.486c0 .086.07.155.156.155h.562c.086 0 .155-.07.155-.155V4.918a.156.156 0 0 0-.155-.156zm3.863 0a.156.156 0 0 0-.156.156v2.07L7.923 4.832l-.013-.015v-.001l-.01-.01-.003-.003-.011-.009h-.001L7.88 4.79l-.003-.002-.005-.003-.008-.005h-.002l-.003-.002-.01-.004-.004-.002-.01-.003h-.002l-.003-.001-.009-.002h-.006l-.003-.001h-.004l-.002-.001h-.574a.156.156 0 0 0-.156.155v3.486c0 .086.07.155.156.155h.56c.087 0 .157-.07.157-.155v-2.07l1.6 2.16a.2.2 0 0 0 .039.038l.001.001.01.006.004.002.008.004.007.003.005.002.01.003h.003a.2.2 0 0 0 .04.006h.56c.087 0 .157-.07.157-.155V4.918a.156.156 0 0 0-.156-.156zm3.815.717v-.56a.156.156 0 0 0-.155-.157h-2.242a.16.16 0 0 0-.108.044h-.001l-.001.002-.002.003a.16.16 0 0 0-.044.107v3.486c0 .041.017.08.044.107l.002.003.002.002a.16.16 0 0 0 .108.043h2.242c.086 0 .155-.07.155-.156v-.56a.156.156 0 0 0-.155-.157H11.81v-.589h1.525c.086 0 .155-.07.155-.156v-.56a.156.156 0 0 0-.155-.157H11.81v-.589h1.525c.086 0 .155-.07.155-.156Z"
                      />
                    </svg>
                    Line</a
                  >
                </li>
              </ul>
            </li>
          </ul>
        </div>
        {% if current_user.is_authenticated %}
        <div class="dropdown">
          <a
            class="btn member-login-icon"
            href="#"
            role="button"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="23"
              height="23"
              fill="currentColor"
              class="bi bi-person"
              viewBox="0 0 16 16"
              style="cursor: pointer; color: #727d6b"
            >
              <path
                d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z"
              />
            </svg>
          </a>

          <ul class="dropdown-menu">
            <li>
              <a class="dropdown-item" href="{{ url_for('logout') }}">登出</a>
            </li>
            <li>
              <a class="dropdown-item" href="{{ url_for('showMember') }}"
                >會員資料</a
              >
            </li>
          </ul>
        </div>
        <!--<a role="button" tabindex="0" data-bs-toggle="popover" data-bs-trigger="focus" data-bs-html="true" data-bs-placement="bottom" data-bs-content='<a href="{{ url_for('logout') }}">登出</a><br><a href="{{ url_for('showMember') }}">會員資料</a>'>
              <svg xmlns="http://www.w3.org/2000/svg" width="23" height="23" fill="currentColor" class="bi bi-person" viewBox="0 0 16 16" style="cursor: pointer; color:#727d6b">
                <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z"/>
              </svg>
            </a>!-->
        {% else %}
        <a href="/login">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="23"
            height="23"
            fill="currentColor"
            class="bi bi-person"
            viewBox="0 0 16 16"
            style="cursor: pointer; color: #727d6b"
          >
            <path
              d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z"
            />
          </svg>
          {% endif %}
        </a>
        <svg
          width="20px"
          height="20px"
          xmlns="http://www.w3.org/2000/svg"
          width="16"
          height="16"
          fill="currentColor"
          class="bi bi-cart"
          viewBox="0 0 16 16"
          style="cursor: pointer; color: #727d6b"
          data-bs-toggle="offcanvas"
          href="#offcanvasExample"
          role="button"
          aria-controls="offcanvasExample"
        >
          <path
            d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5M3.102 4l1.313 7h8.17l1.313-7zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4m7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4m-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2m7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2"
          />
        </svg>
      </div>
    </nav>
    <div
      class="offcanvas offcanvas-start"
      tabindex="-1"
      id="offcanvasExample"
      aria-labelledby="offcanvasExampleLabel"
    >
      <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="offcanvasExampleLabel">
          您的購物車內容：
        </h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="offcanvas"
          aria-label="Close"
        ></button>
      </div>
      <div class="scroll-body">
        <div id="offcanvas-body"></div>
        <div
          class="inCart_buyNow"
          id="checkout-button"
          style="margin: 20px; padding: 10px"
          onclick="onlyLoggedIn();"
        >
          結帳
        </div>
      </div>
    </div>
    <div class="product-wrapper" style="display: flex; justify-content: center">
      <div class="product-container" style="text-align: left">
        <img
          src="{{ product.image_url }}"
          alt="{{ product.name }}"
          class="product-image"
          style="display: block; width: 500px; margin-top: 30px"
        />
        <div class="product-detail">
          <h1 style="margin-top: 30px">{{ product.name }}</h1>
          <p class="product-notice">{{ product.description }}</p>
          <h5>NT${{ product.price }}</h5>
          <span class="quantity-label">數量：</span>
        </div>
        <div class="btn minus" id="min_1"><b>-</b></div>
        <input
          class="quantity"
          name="quantity_1"
          value="1"
          id="quantity_1"
          max="{{ product.quantity }}"
          style="text-align: center; margin-bottom: 20px"
        />
        <div class="btn plus" id="plus_1"><b>+</b></div>
        <div class="inventory">尚有：{{product.quantity}}</div>
        <br />

        <div class="button-container">
          <div
            class="add-to-cart"
            data-bs-toggle="offcanvas"
            href="#offcanvasExample"
            role="button"
            aria-controls="offcanvasExample"
            onclick="addToCart();"
          >
            加入購物車
          </div>
          <div class="buy-now" onclick="buyNow();">直接購買</div>
        </div>
      </div>
    </div>

    <div class="container">
      <footer
        class="row row-cols-1 row-cols-sm-2 row-cols-md-5 py-5 my-5 border-top"
      >
        <div class="col mb-3">
          <a
            href="/"
            class="d-flex align-items-center mb-3 link-body-emphasis text-decoration-none"
          >
            <img
              src="static/resources/專題提案_第1組__1_-removebg-preview.png"
              alt="Logo"
              width="100"
              height="100"
            />
            <svg class="bi me-2" width="40" height="32">
              <use xlink:href="#bootstrap" />
            </svg>
          </a>
          <p class="text-body-secondary">&copy; 2024</p>
        </div>

        <div class="col mb-2">
          <h5>INFO</h5>
          <ul class="nav flex-column">
            <li class="nav-item mb-2">
              <a href="#" class="nav-link p-0 text-body-secondary"
                >品牌故事 | Our Story</a
              >
            </li>
            <li class="nav-item mb-2">
              <a href="#" class="nav-link p-0 text-body-secondary"
                >訂購須知 | Orders</a
              >
            </li>
          </ul>
        </div>

        <div class="col mb-2">
          <h5>SERVICE TIME</h5>
          <ul class="nav flex-column">
            <li class="nav-item mb-2 service-time">Monday - Friday</li>
            <li class="nav-item mb-2 service-time">10:30 - 19:30</li>
          </ul>
        </div>

        <!--<div class="col mb-3">
            <h5>Section</h5>
            <ul class="nav flex-column">
              <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-body-secondary">Home</a></li>
              <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-body-secondary">Features</a></li>
              <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-body-secondary">Pricing</a></li>
              <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-body-secondary">FAQs</a></li>
              <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-body-secondary">About</a></li>
            </ul>
          </div>!-->
      </footer>
    </div>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
  </body>
  <!--JS Start-->
  <script>
    // 当窗口加载完成后执行代码
    window.addEventListener("load", function () {
      // 增加数量的函数
      function increaseQuantity() {
        // 获取输入框元素和库存数量
        const quantityInput = document.getElementById("quantity_1");
        const maxQuantity = parseInt(quantityInput.getAttribute("max"));
        // 获取当前数量并增加，但不能超过库存数量
        let currentQuantity = parseInt(quantityInput.value);
        if (currentQuantity < maxQuantity) {
          currentQuantity++;
          // 更新输入框中的数量
          quantityInput.value = currentQuantity;
          // 使用 console.log 打印当前数量
          console.log("當前數量:", currentQuantity);
        } else {
          console.log("已達到最大庫存數量:", maxQuantity);
        }
      }

      // 减少数量的函数
      function decreaseQuantity() {
        // 获取输入框元素
        const quantityInput = document.getElementById("quantity_1");
        // 获取当前数量并减少
        let currentQuantity = parseInt(quantityInput.value);
        // 确保数量不低于 1
        if (currentQuantity > 1) {
          currentQuantity--;
          // 更新输入框中的数量
          quantityInput.value = currentQuantity;
          // 使用 console.log 打印当前数量
          console.log("當前數量:", currentQuantity);
        }
      }

      // 绑定加号和减号按钮的点击事件
      document
        .getElementById("plus_1")
        .addEventListener("click", increaseQuantity);
      document
        .getElementById("min_1")
        .addEventListener("click", decreaseQuantity);

      // 页面加载时更新购物车显示
      const cart = getCartFromCookies();
      updateCartUI(cart);
    });

    function addToCart() {
      //clearCartCookies();
      const productName =
        document.querySelector(".product-detail h1").textContent;
      console.log(productName);
      const quantityInput = document.getElementById("quantity_1");
      let currentQuantity = parseInt(quantityInput.value);
      const availableQuantity = parseInt(
        document.querySelector(".inventory").textContent.split("：")[1]
      );
      console.log(availableQuantity);
      const urlParams = new URLSearchParams(window.location.search);
      const productId = urlParams.get("product_id");

      // 获取商品价格
      const price = parseFloat(
        document
          .querySelector(".product-detail h5")
          .textContent.replace("NT$", "")
          .trim()
      );
      console.log(price);

      // 获取现有的购物车数据
      let cart = getCartFromCookies();
      // 检查购物车中已有的商品数量加上要购买的数量是否超过库存数量
      if (
        cart[productId] &&
        cart[productId].quantity + currentQuantity > availableQuantity
      ) {
        alert("商品數量不足或購物車已有商品！無法加入購物車~");
        return; // 停止执行后续代码
      }

      console.log(cart);
      // 如果购物车中已有该商品，更新数量；否则新增商品
      if (cart[productId]) {
        cart[productId].quantity += currentQuantity;
        cart[productId].price = price;
      } else {
        cart[productId] = {
          productId: productId,
          productName: productName,
          quantity: currentQuantity,
          price: price,
        };
      }

      // 更新购物车到cookie
      setCartToCookies(cart);
      updateCartUI(cart);
    }

    // 定义函数：更新购物车UI显示
    function updateCartUI(cart) {
      const offcanvasBody = document.getElementById("offcanvas-body");
      offcanvasBody.innerHTML = ""; // 清空当前购物车显示内容
      let totalPrice = 0; // 初始化总价为0

      for (const [product, details] of Object.entries(cart)) {
        console.log(details.price);
        console.log(details.quantity);
        const productTotal = details.price * details.quantity;
        const productInfoDiv = document.createElement("div");
        productInfoDiv.textContent = `${details.productName} * ${
          details.quantity
        } - NT$${productTotal.toFixed(2)}`;
        offcanvasBody.appendChild(productInfoDiv);

        totalPrice += productTotal; // 累加总价
      }

      // 创建并添加总价显示
      const totalPriceDiv = document.createElement("div");
      totalPriceDiv.textContent = `總價: NT$${totalPrice.toFixed(2)}`;
      totalPriceDiv.style.fontWeight = "bold";
      totalPriceDiv.style.marginTop = "10px";
      offcanvasBody.appendChild(totalPriceDiv);
    }

    function onlyLoggedIn() {
      if (!isLoggedIn()) {
        alert("請先登入再結帳！");
        // 这里可以跳转到登录页面
        window.location.href = "/login";
      } else {
        // 跳转到结账页面或执行结账操作
        window.location.href = "/Checkout";
      }
    }

    function isLoggedIn() {
      // 检查是否存在名为 "user_id" 的 session
      console.log("{{ is_logged_in }}");
      var loggedIn = "{{ is_logged_in }}" === "True"; // 将模板变量解析为布尔值
      console.log(loggedIn);
      return loggedIn;
    }

    //清空cookie
    function clearCartCookies() {
      document.cookie = "cart=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
    }

    // 定义函数：从Cookies中获取购物车数据
    function getCartFromCookies() {
      const cartCookie = document.cookie
        .split("; ")
        .find((row) => row.startsWith("cart="));
      if (cartCookie) {
        return JSON.parse(cartCookie.split("=")[1]);
      } else {
        return {};
      }
    }

    // 定义函数：将购物车数据设置到Cookies中
    function setCartToCookies(cart) {
      console.log("Before setting cookie:", cart); // 添加调试语句
      document.cookie = `cart=${JSON.stringify(cart)};path=/`; // Cookie有效期1年
      console.log("After setting cookie:", document.cookie); // 添加调试语句
    }

    function buyNow() {
      const productName =
        document.querySelector(".product-detail h1").textContent;
      console.log(productName);
      const quantityInput = document.getElementById("quantity_1");
      let currentQuantity = parseInt(quantityInput.value);
      const availableQuantity = parseInt(
        document.querySelector(".inventory").textContent.split("：")[1]
      );
      console.log(availableQuantity);
      const urlParams = new URLSearchParams(window.location.search);
      const productId = urlParams.get("product_id");

      // 获取商品价格
      const price = parseFloat(
        document
          .querySelector(".product-detail h5")
          .textContent.replace("NT$", "")
          .trim()
      );
      console.log(price);

      // 获取现有的购物车数据
      let cart = getCartFromCookies();
      // 检查购物车中已有的商品数量加上要购买的数量是否超过库存数量

      console.log(cart);
      // 如果购物车中已有该商品，更新数量；否则新增商品
      if (cart[productId]) {
        cart[productId].quantity += currentQuantity;
        cart[productId].price = price;
      } else {
        cart[productId] = {
          productName: productName,
          quantity: currentQuantity,
          price: price,
        };
      }

      // 更新购物车到cookie
      setCartToCookies(cart);
      updateCartUI(cart);
      onlyLoggedIn();
    }
  </script>
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"
  ></script>
</html>
